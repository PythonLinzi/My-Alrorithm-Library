import numpy as np
from scipy.optimize import least_squares

# 数学建模算法与应用 page 93 例exp: 5-8
def f(k):
    ans = []
    x = [[15.02, 23.73, 5.49, 1.21], [12.62, 22.34, 4.32, 1.35],
            [14.86, 28.84, 5.04, 1.92], [13.98, 27.67, 4.72, 1.49],
            [15.91, 20.83, 5.35, 1.56], [12.47, 22.27, 4.27, 1.50],
            [15.80, 27.57, 5.25, 1.85], [14.32, 28.01, 4.62, 1.51],
            [13.76, 24.79, 4.42, 1.46], [15.18, 28.96, 5.30, 1.66],
            [14.20, 25.77, 4.87, 1.64], [17.07, 23.17, 5.80, 1.90],
            [15.40, 28.57, 5.22, 1.66], [15.94, 23.52, 5.18, 1.98],
            [14.33, 21.86, 4.86, 1.59], [15.11, 28.95, 5.18, 1.37],
            [13.81, 24.53, 4.88, 1.39], [15.58, 27.65, 5.02, 1.66],
            [15.85, 27.29, 5.55, 1.70], [15.28, 29.07, 5.26, 1.82],
            [16.40, 32.47, 5.18, 1.75], [15.02, 29.65, 5.08, 1.70],
            [15.73, 22.11, 4.90, 1.81], [14.75, 22.43, 4.65, 1.82],
            [14.35, 20.04, 5.08, 1.53]]
    for i in range(len(x)):
        tmp = np.exp(-k[0] * x[i][1]) * np.sin(k[1] * x[i][2]) + x[i][3] ** 2 - x[i][0]
        ans.append(tmp)
    return np.array(ans)

k0 = np.random.rand(2)
k0 = (5.17, 0.57)
ans = least_squares(fun=f, x0=k0)
print(ans)
